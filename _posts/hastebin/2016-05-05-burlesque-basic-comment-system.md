[object Object]

This post is about Burlesque, a new comment management system for Jekyll implemented in Node.js. When I build my first blog a few months ago and published it to github, one of the first thing that bothered me was the lack of a clean, simple way to gather user comments. Jekyll being only a static blogging engine did not have the ability to collect and display comment in real time. However I learnt that there were free hosted comment plugins that I could include in my blog with just a few lines of javascript. The primary contender among them was Disqus, an American company that offered free blog comment hosting to everybody which advertised itself as the community of communities. Some other alternatives I found were facebook comments and Google Plus comment plugin. But the fact remained that all of these plugins or widgets as they're called are third party online scripts that could potentially compromise a user's privacy. Besides I had no intention of adding foreign dynamic javascript code to a static page. I was at a dilemma. Many fellow bloggers recommended that I get rid of the idea of comments altogether and focus on content. Comments, they said were an unnecessary evil. Most of the time readers do not have time to contribute something of value, they said. But I was not so easily dissuaded. I knew comments were a useful tool to get my readers to participate and share their opinions. To this end I searched for a comment management software that I could host myself. Two such comment management software I found were Isso and Hashover. But here too there was trouble. Both were exactly the same as Disqus. Both injected extra javascript into each page and both loaded comments after the page had finished loading. I knew that to keep with the philosophy of static web content I had to figure out some way to make comments a part of my content instead of an overburdening extension.

The first basic condition that I lay down for myself was that the comments should not be loaded using javascript on the client side. Instead it had to be included during a rebuild. The second condition was strong data security and user anonymity. The third condition was that I should not burden the end user overmuch. To that end I must try to keep the process of submitting comments as simple as possible. Now one of the many ideas I came across for including comments on a static Jekyll blog was to make the reader mail her/his comments to me. The third condition meant that this was absolutely out of the question. For who would want to open a mail client or webmail client simply to express his/her opinion? Any I knew for a fact that most people do not have a mail client configured on their computer. The idea that I found most suitable was the one put forward by  Phil Hawksworth in his blog [Hawksworx](http://hawksworx.com/). The idea is deceptively simple and involves a literal going back to the roots approach. A long, long time ago forms were collected using PHP and not AJAX. A form would simply pass along the collected data to a php page as a POST request. The PHP page would process it and save it in a MySQL database. You could argue that the same goes on today and nothing has changed. I admit that you are right but remember that the essence of a static web page is minimalism. To make the most out of the least amount. A Zen interpretation of what it means to blog. 

To me the idea of a simple safe script always receptive to new data fits in perfectly with my self imposed conditions. In mind I have it chalked out clearly. Use a new web technology like Node.js to act as the recipient, save the data somewhere securely where it can be accessed just at the moment of rebuild. To this end I created Burlesque Server and the Burlesque widget which can be loaded and included in the blog during build time. Burlesque means an absurd or comically exaggerated imitation of something, especially in a literary or dramatic work; a parody. I chose the name Burlesque because a comment system for Jekyll really is a parody because it takes something as simple as posting a comment and turns it into something grotesque.

The flow diagram for the concept is give below. I'll take just a moment to add another condition to the list above. Condition five, the services used  must be simple as possible. Burlesque therefore requires very little dependencies. I coded the server using only barebone Node.js so as to make it super fast. An important consideration I had to make was to decide where to store the comments posted by the user. First I thought of using a database. But then I realized that it would make my application slow and the idea of initializing and maintaining a database -- NoSQL or not -- was inelegant. Where else could I store my comments? I considered cloud storage option like Dropbox and Google Drive and even Github repositories before I thought of Github Gist. To be sure every Gist is a repository in its own right. But the beauty was that Gist was meant for keeping notes on development and records on errors. To this end the API is a piece of cake. And by using a service that I was sure every Jekyll blogger used I could be sure of keeping things simple.

Burlesque works in this way. The user submits a html form which is posted to the Burlesque server. The Burlesque server processes and verifies the data and then saves it in a secret Github Gist. During rebuild, an api call to the Burlesque server fetches the comments in a YAML or JSON file and it is included in the blog by the Burlesque widget. I had previously used the Pooleapp to store and fetch comments and so I decided to store the comments in the same format. Which means that if your blog works with Poole then it will work with Burlesque. But what makes Burlesque different from Pooleapp, you ask. The answer is simple. You control the data! Burlesque comes with AES symmetric key encryption which means your precious comment data is encrypted before being stored on Github Gist. Only you and the Burlesque server have the key to encrypt and read the stored data. Burlesque has a built in Gravatar and also supports a simple webhook so that you can publish your post directly from [Draft](https://draftin.com/).



